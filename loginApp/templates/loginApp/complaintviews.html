
{% load static %}
{% load django_bootstrap5 %}
{% bootstrap_css %}
{% bootstrap_javascript %}
<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Admin Dashboard</title>
</head>
<body>
   <div class="container mt-4 text-center">
    <a href="/">
        Back to dashboard
    </a>
       <h1>Welcome, {{ user.username }}! Viewing complaint {{ complaints.id }}</h1>
       <a href="{% url 'logout' %}" class="btn btn-danger">Logout</a>
       <hr>
       <h2>Complaints Overview</h2>
       <div class="list-group mt-4">
           <h5 class="mb-1">{{ complaints.name }}</h5>
           <p class="mb-1">Location: {{ complaints.location }}</p>
           <p class="mb-1">Description: {{ complaints.description|truncatechars:100 }}</p>
           {% for upload in complaints.uploads.all %}
               {% if upload.is_image %}
                   <img src="{{ upload.url }}" alt="Image preview" class="img-fluid">
               {% elif upload.is_pdf %}
                   <iframe src="{{ upload.url }}" width="100%" height="200"></iframe>
               {% elif upload.is_text %}
                   <a href="{{ upload.url }}" target="_blank">View Text File</a>
               {% else %}
                   <a href="{{ upload.url }}" target="_blank">Download File</a>
               {% endif %}
           {% endfor %}
           {% if complaints.user %}
               <small>By: {{ complaints.user.username }}</small>
           {% else %}
               <small>By: Anonymous</small>
           {% endif %}
           {% if complaints.review %}
               <small>{{ complaints.review }}</small>
           {% endif %}
           <small>{{ complaints.status }}</small>
           {% if complaints.status == 'reviewed' %}
               <p>Status: Reviewed</p>
           {% elif complaints.status == 'in_progress' or complaints.status == 'notreviewed' %}
               <form action="" method="post">
                   {% csrf_token %}
                   <label for="status">Set Status:</label>
                   <select id="status" name="status">
                       <option value="in_progress" selected>In Progress</option>
                       <option value="reviewed">Reviewed</option>
                   </select>
                   <label for="review">Enter your review:</label>
                   <br>
                   <textarea id="review" name="review" rows="4" cols="50"></textarea><br>
                   <button type="submit" class="btn btn-primary">Submit</button>
               </form>
           {% else %}
               <form action="" method="post">
                   {% csrf_token %}
                   <label for="status">Set Status:</label>
                   <select id="status" name="status">
                       <option value="in_progress">In Progress</option>
                       <option value="reviewed">Reviewed</option>
                       <!-- Add more options as needed -->
                   </select>
                   <button type="submit" class="btn btn-primary">Submit</button>
               </form>
           {% endif %}
       </div>
   </div>
</body>
</html>
